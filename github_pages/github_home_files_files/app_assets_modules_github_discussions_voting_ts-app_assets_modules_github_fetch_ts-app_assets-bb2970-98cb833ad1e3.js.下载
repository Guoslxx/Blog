"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_discussions_voting_ts-app_assets_modules_github_fetch_ts-app_assets-bb2970"],{5256(a,b,c){c.d(b,{N:()=>f,x:()=>g});var d=c(80721);let e=null;function f(a){g(h(a))}function g(a){e&&(e.textContent="",e.textContent=a)}function h(a){return(a.getAttribute("aria-label")||a.innerText||"").trim()}!async function(){await d.x,(e=document.createElement("div")).setAttribute("aria-live","polite"),e.classList.add("sr-only"),document.body.append(e)}()},67780(a,b,c){var d=c(5256),e=c(64463);let f=async(a,b,c,d)=>{let e=new FormData;return!0===d&&e.append("upvote","true"),await fetch(a,{body:"delete"===c?"":e,method:c,mode:"same-origin",headers:{"Scoped-CSRF-Token":b}})};class VoteCountElement{getLabel(){return this.voteCountElement?.getAttribute("data-upvote-label")||""}getText(){return this.voteCountElement?.textContent||""}constructor(a){this.voteCountElement=a}}class VoteFormElement{isUpvoted(){let a=this.voteForm.getAttribute("data-upvoted");return"true"===a}getCsrfDeleteInputValue(){let a=this.voteForm.querySelector(".js-data-url-delete-csrf");return a?a.value:""}getCsrfPutInputValue(){let a=this.voteForm.querySelector(".js-data-url-put-csrf");return a?a.value:""}simulateUpvote(){this.voteForm.setAttribute("data-upvoted","true"),this.voteForm.getAttribute("data-new-upvote")&&(this.voteForm.querySelector(".js-upvote-button")?.classList.add("user-has-reacted","color-bg-accent"),this.voteForm.querySelector(".js-upvote-button")?.classList.remove("color-fg-muted")),this.voteForm.classList.add("is-upvoted"),this.voteButton?.setAttribute("aria-label",this.upvotedCountElement.getLabel()),this.voteButton?.setAttribute("aria-pressed","true"),(0,d.x)(`${this.upvotedCountElement.getText()} Upvotes`)}simulateUpvoteDeletion(){this.voteForm.setAttribute("data-upvoted","false"),this.voteForm.getAttribute("data-new-upvote")&&(this.voteForm.querySelector(".js-upvote-button")?.classList.remove("user-has-reacted","color-bg-accent"),this.voteForm.querySelector(".js-upvote-button")?.classList.add("color-fg-muted")),this.voteForm.classList.remove("is-upvoted"),this.voteButton?.setAttribute("aria-label",this.defaultVoteCountElement.getLabel()),this.voteButton?.setAttribute("aria-pressed","false"),(0,d.x)(`${this.defaultVoteCountElement.getText()} Upvotes`)}displayUpVoteError(a){let b=this.voteForm.querySelector(".js-upvote-error");b instanceof HTMLElement&&(b.textContent=a,b.hidden=!1)}hideVoteErrors(){let a=this.voteForm.querySelector(".js-upvote-error");a instanceof HTMLElement&&(a.hidden=!0)}constructor(a){this.voteForm=a,this.voteButton=this.voteForm.querySelector(".js-upvote-button"),this.defaultVoteCountElement=new VoteCountElement(a.querySelector(".js-default-vote-count")),this.upvotedCountElement=new VoteCountElement(a.querySelector(".js-upvoted-vote-count")),this.url=this.voteForm.getAttribute("data-url")||""}}class Upvote{animateUpvote(a){a?this.voteFormElement.simulateUpvoteDeletion():this.voteFormElement.simulateUpvote()}animateUpvoteUndo(a){a?this.voteFormElement.simulateUpvote():this.voteFormElement.simulateUpvoteDeletion()}async click(){this.voteFormElement.hideVoteErrors();let a=this.voteFormElement.isUpvoted(),b=a?this.voteFormElement.getCsrfDeleteInputValue():this.voteFormElement.getCsrfPutInputValue();this.animateUpvote(a);let c=await f(this.voteFormElement.url,b,a?"delete":"put",!a);if(!c.ok){let d=await c.json();this.voteFormElement.displayUpVoteError(d.error),this.animateUpvoteUndo(a)}}constructor(a){this.voteFormElement=a}}(0,e.N7)(".js-upvote-button",a=>{if(!(a instanceof HTMLElement)||!(a.parentElement instanceof HTMLElement))return;let b=new Upvote(new VoteFormElement(a.parentElement));a.addEventListener("click",async()=>{await b.click()})})},80721(a,b,c){c.d(b,{C:()=>e,x:()=>d});let d="interactive"===document.readyState||"complete"===document.readyState?Promise.resolve():new Promise(a=>{document.addEventListener("DOMContentLoaded",()=>{a()})}),e="complete"===document.readyState?Promise.resolve():new Promise(a=>{window.addEventListener("load",a)})},98249(a,b,c){c.d(b,{D:()=>g,a:()=>f});var d=c(2825),e=c(75662);async function f(a,b,c){let f=new Request(b,c);f.headers.append("X-Requested-With","XMLHttpRequest");let g=await self.fetch(f);if(g.status<200||g.status>=300)throw Error(`HTTP ${g.status}${g.statusText||""}`);return(0,d.t)((0,d.P)(a),g),(0,e.r)(a,await g.text())}function g(a,b,c=1e3){return async function c(d){let e=new Request(a,b);e.headers.append("X-Requested-With","XMLHttpRequest");let f=await self.fetch(e);if(f.status<200||f.status>=300)throw Error(`HTTP ${f.status}${f.statusText||""}`);if(200===f.status)return f;if(202===f.status)return await new Promise(a=>setTimeout(a,d)),c(1.5*d);throw Error(`Unexpected ${f.status} response status from poll endpoint`)}(c)}},2825(a,b,c){function d(a){let b=[...a.querySelectorAll("meta[name=html-safe-nonce]")].map(a=>a.content);if(b.length<1)throw Error("could not find html-safe-nonce on document");return b}c.d(b,{P:()=>d,t:()=>e});class ResponseError extends Error{constructor(a,b){super(`${a} for HTTP ${b.status}`),this.response=b}}function e(a,b,c=!1){let d=b.headers.get("content-type")||"";if(!c&&!d.startsWith("text/html"))throw new ResponseError(`expected response with text/html, but was ${d}`,b);if(c&&!(d.startsWith("text/html")||d.startsWith("application/json")))throw new ResponseError(`expected response with text/html or application/json, but was ${d}`,b);let e=b.headers.get("x-html-safe");if(e){if(!a.includes(e))throw new ResponseError("response X-HTML-Safe nonce did not match",b)}else throw new ResponseError("missing X-HTML-Safe nonce",b)}},254(a,b,c){c.d(b,{ZG:()=>h,q6:()=>j,w4:()=>i});var d=c(8439);let e=!1,f=new d.Z;function g(a){let b=a.target;if(b instanceof HTMLElement&&b.nodeType!==Node.DOCUMENT_NODE)for(let c of f.matches(b))c.data.call(null,b)}function h(a,b){e||(e=!0,document.addEventListener("focus",g,!0)),f.add(a,b),document.activeElement instanceof HTMLElement&&document.activeElement.matches(a)&&b(document.activeElement)}function i(a,b,c){function d(b){let e=b.currentTarget;e&&(e.removeEventListener(a,c),e.removeEventListener("blur",d))}h(b,function(b){b.addEventListener(a,c),b.addEventListener("blur",d)})}function j(a,b){function c(a){let{currentTarget:d}=a;d&&(d.removeEventListener("input",b),d.removeEventListener("blur",c))}h(a,function(a){a.addEventListener("input",b),a.addEventListener("blur",c)})}},75662(a,b,c){c.d(b,{r:()=>d});function d(a,b){let c=a.createElement("template");return c.innerHTML=b,a.importNode(c.content,!0)}},86702(a,b,c){c.d(b,{Z:()=>d,"_":()=>e});class NoOpStorage{getItem(){return null}setItem(){}removeItem(){}clear(){}key(){return null}get length(){return 0}}function d(a,b={throwQuotaErrorsOnSet:!1},c=window,d=a=>a,e=a=>a){let f;try{f=c[a]}catch{f=new NoOpStorage}let{throwQuotaErrorsOnSet:g}=b;return{getItem:function(a){try{let b=f.getItem(a);return b?d(b):null}catch(c){return null}},setItem:function(a,b){try{f.setItem(a,e(b))}catch(c){if(g&&c.message.toLowerCase().includes("quota"))throw c}},removeItem:function(a){try{f.removeItem(a)}catch(b){}}}}function e(a){return d(a,{throwQuotaErrorsOnSet:!1},window,JSON.parse,JSON.stringify)}},25811(a,b,c){c.d(b,{LS:()=>f,cl:()=>g,rV:()=>e});var d=c(86702);let{getItem:e,setItem:f,removeItem:g}=(0,d.Z)("sessionStorage")},55065(a,b,c){c.d(b,{"$g":()=>SoftNavSuccessEvent,OV:()=>SoftNavStartEvent,QW:()=>SoftNavErrorEvent,Xr:()=>SoftNavEndEvent});var d=c(45586);class SoftNavEvent extends Event{constructor(a,b){super(b),this.mechanism=a}}class SoftNavStartEvent extends SoftNavEvent{constructor(a){super(a,d.QE.START)}}class SoftNavSuccessEvent extends SoftNavEvent{constructor(a,b){super(a,d.QE.SUCCESS),this.visitCount=b}}class SoftNavErrorEvent extends SoftNavEvent{constructor(a,b){super(a,d.QE.ERROR),this.error=b}}class SoftNavEndEvent extends SoftNavEvent{constructor(a){super(a,d.QE.END)}}},45586(a,b,c){c.d(b,{jN:()=>j,QE:()=>i,FP:()=>p,r_:()=>o,Yl:()=>l,TL:()=>q,LD:()=>m,BT:()=>n,u5:()=>r});var d=c(55065),e=c(34855),f=c(58843);let g="stats:soft-nav-duration",h={turbo:"TURBO",react:"REACT","turbo.frame":"FRAME",ui:"UI"},i=Object.freeze({INITIAL:"soft-nav:initial",START:"soft-nav:start",SUCCESS:"soft-nav:success",ERROR:"soft-nav:error",FRAME_UPDATE:"soft-nav:frame-update",END:"soft-nav:end",RENDER:"soft-nav:render",PROGRESS_BAR:{START:"soft-nav:progress-bar:start",END:"soft-nav:progress-bar:end"}}),j="reload",k=0;function l(){k=0,document.dispatchEvent(new Event(i.INITIAL)),(0,f.XL)()}function m(a){(0,f.sj)()||(s(),document.dispatchEvent(new d.OV(a)),(0,f.U6)(a),(0,f.J$)(),(0,f.Nt)(),performance.mark(g))}function n(a={}){u(a)&&(k+=1,document.dispatchEvent(new d.$g((0,f.Gj)(),k)),p(a))}function o(a={}){var b;if(!u(a))return;k=0;let c=(0,f.Wl)()||j;document.dispatchEvent(new d.QW((0,f.Gj)(),c)),t(),b=c,(0,e.b)({turboFailureReason:b,turboStartUrl:(0,f.wP)(),turboEndUrl:window.location.href}),(0,f.XL)()}function p(a={}){u(a)&&(t(),document.dispatchEvent(new d.Xr((0,f.Gj)())),(0,f.pS)())}function q(a={}){u(a)&&(!function(){let a=function(){if(0===performance.getEntriesByName(g).length)return null;performance.measure(g,g);let a=performance.getEntriesByName(g),b=a.pop();return b?b.duration:null}();if(!a)return;let b=h[(0,f.Gj)()],c=Math.round(a);b===h.react&&document.dispatchEvent(new CustomEvent("staffbar-update",{detail:{duration:c}})),(0,e.b)({requestUrl:window.location.href,softNavigationTiming:{mechanism:b,destination:(0,f.Nb)()||"rails",duration:c,initiator:(0,f.CI)()||"rails"}})}(),document.dispatchEvent(new Event(i.RENDER)))}function r(){document.dispatchEvent(new Event(i.FRAME_UPDATE))}function s(){document.dispatchEvent(new Event(i.PROGRESS_BAR.START))}function t(){document.dispatchEvent(new Event(i.PROGRESS_BAR.END))}function u({skipIfGoingToReactApp:a,allowedMechanisms:b=[]}={}){return(0,f.sj)()&&(0===b.length||b.includes((0,f.Gj)()))&&(!a||!(0,f.Nb)())}},58843(a,b,c){c.d(b,{Ak:()=>r,CI:()=>v,Gj:()=>o,"J$":()=>u,Nb:()=>w,Nt:()=>s,OE:()=>p,U6:()=>l,Wl:()=>q,XL:()=>k,pS:()=>m,sj:()=>n,wP:()=>t});var d=c(25811),e=c(45586);let f="soft-nav:fail",g="soft-nav:fail-referrer",h="soft-nav:referrer",i="soft-nav:marker",j="soft-nav:react-app-name";function k(){(0,d.LS)(i,"0"),(0,d.cl)(h),(0,d.cl)(f),(0,d.cl)(g),(0,d.cl)(j)}function l(a){(0,d.LS)(i,a)}function m(){(0,d.LS)(i,"0")}function n(){let a=(0,d.rV)(i);return a&&"0"!==a}function o(){return(0,d.rV)(i)}function p(){return Boolean(q())}function q(){return(0,d.rV)(f)}function r(a){(0,d.LS)(f,a||e.jN),(0,d.LS)(g,window.location.href)}function s(){(0,d.LS)(h,window.location.href)}function t(){return(0,d.rV)(h)||document.referrer}function u(){let a=w();a?(0,d.LS)(j,a):(0,d.cl)(j)}function v(){return(0,d.rV)(j)}function w(){return document.querySelector('meta[name="ui"]')?"ui":document.querySelector("react-app")?.getAttribute("app-name")}},34855(a,b,c){c.d(b,{b:()=>f});var d=c(80721);let e=[];function f(a,b=!1){void 0===a.timestamp&&(a.timestamp=new Date().getTime()),a.loggedIn=j(),a.staff=k(),e.push(a),b?i():h()}let g=null;async function h(){await d.C,null==g&&(g=window.requestIdleCallback(i))}function i(){if(g=null,!e.length)return;let a=document.head?.querySelector('meta[name="browser-stats-url"]')?.content;if(!a)return;let b=JSON.stringify({stats:e});try{navigator.sendBeacon&&navigator.sendBeacon(a,b)}catch{}e=[]}function j(){return!!document.head?.querySelector('meta[name="user-login"]')?.content}function k(){return!!document.head?.querySelector('meta[name="user-staff"]')?.content}document.addEventListener("pagehide",i),document.addEventListener("visibilitychange",i)}}])
//# sourceMappingURL=app_assets_modules_github_discussions_voting_ts-app_assets_modules_github_fetch_ts-app_assets-bb2970-b064503a53b5.js.map